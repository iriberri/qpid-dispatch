os:
- linux
sudo: required
language:
- python
python:
- 2.7
addons:
  apt:
    packages:
    - cmake
    - cmake-curses-gui
    - uuid-dev
    - libssl-dev
    - libsasl2-2
    - libsasl2-dev
    - swig
    - python-dev
    - ruby-dev
    - libperl-dev
    - git
    - make
    - doxygen
    - valgrind

before_install:
- git submodule add https://github.com/apache/qpid-proton.git
- git submodule init
- git submodule update
before_script:
- export PATH=${HOME}/.local/bin:${PATH}
- cd qpid-proton
- mkdir build
- cd build
- cmake .. -DSYSINSTALL_BINDINGS=OFF -DBUILD_GO=OFF -DCMAKE_INSTALL_PREFIX=/usr -DSYSINSTALL_PYTHON=OFF
- sudo make install
- cd ../..
- mkdir build
- cd build
- cmake .. -DCMAKE_INSTALL_PREFIX=/usr
- sudo make install
script:
- env PYTHON_CONFIGURE_OPTS="--enable-shared"
- export LD_LIBRARY_PATH=/home/travis/virtualenv/python2.7.9/lib:$LD_LIBRARY_PATH
- export PYTHONPATH=/home/travis/virtualenv/python2.7.9/lib:/usr/lib/proton/bindings/python:/usr/lib/qpid-dispatch/python:/usr/lib/python2.7/site-packages:$PYTHONPATH
- ctest -V


